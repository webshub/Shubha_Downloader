<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <script>
        var fs =require('fs');
    if(fs.existsSync('licence.txt'))
        {
            window.location.replace("index.html");
        }
        </script>
      <style type="text/css">
<!--
.tdBorder {
	border: thick groove #D6F8FE;
}
-->
</style>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link id="default" rel="stylesheet" type="text/css" href="resources/css/ext-all.css" />
    <script type="text/javascript" src="ext-all.js"></script>

    <!-- Shared -->
    <link rel="stylesheet" type="text/css" href="shared/example.css" />
    <script>
        Ext.require([
    //'Ext.form.*',
    //'Ext.layout.container.Column',
    //'Ext.tab.Panel'
    '*'
]);

Ext.onReady(function() {
    Ext.QuickTips.init();

    var bd = Ext.getBody();

    /*
     * ================  Simple form  =======================
     */
   // bd.createChild({tag: 'h2', html: 'Form 1 - Very Simple'});

    var required = '<span style="color:red;font-weight:bold" data-qtip="Required">*</span>';

    var simple = Ext.widget({
        xtype: 'form',
        layout: 'form',
        //collapsible: true,
        id: 'loginForm',
        //url: 'save-form.php',
        frame: true,
        title: 'Login to Shubha Downloader',
        id:'title',
        bodyPadding: '5 5 0',
        width: 350,
        fieldDefaults: {
            msgTarget: 'side',
            labelWidth: 75
        },
        defaultType: 'textfield',
        items: [{
            fieldLabel: 'Username',
            id:'user_login',
            afterLabelTextTpl: required,
            name: 'first',
			enableKeyEvents: true,
			allowBlank: false,
			listeners: {
			keypress : function(textfield,eventObject){
            if (eventObject.getCharCode() == Ext.EventObject.ENTER) {
               this.up('form').getForm().isValid();
				
                var username=$("#user_login-inputEl").val();
                var password=$("#user_pass-inputEl").val();
                if(username!=''&& password!='')
                {    getdata();}
                else
                     $("#msg").html("Please enter Username & password");
            }
			}
			}
            
        },{
            fieldLabel: 'Password',
            inputType: 'password',
            id:'user_pass',
            afterLabelTextTpl: required,
            name: 'last',
            enableKeyEvents: true,
			allowBlank: false,
			listeners: {
			keypress : function(textfield,eventObject){
            if (eventObject.getCharCode() == Ext.EventObject.ENTER) {
               this.up('form').getForm().isValid();
				
                var username=$("#user_login-inputEl").val();
                var password=$("#user_pass-inputEl").val();
                if(username!=''&& password!='')
                {    getdata();}
                else
                     $("#msg").html("Please enter Username & password");
            }
			}
			}
        }],

        buttons: [{
            text: 'Register',
            handler: function() {
                //this.up('form').getForm().isValid();
                var exec = require('child_process').exec,child;
                child = exec('start http://shubhalabha.in/community/wp-login.php?action=register',//child = exec('TASKKILL /F /IM nw.exe',
                function (error, stdout, stderr) {
                $("#msg").html("Please wait...While openining browser");
                if (error !== null) {
                $("#msg").html(error);
                   }
                });
            }
        },{
            text: 'Log-In',
			
            handler: function() {
                this.up('form').getForm().isValid();
				
                var username=$("#user_login-inputEl").val();
                var password=$("#user_pass-inputEl").val();
                if(username!=''&& password!='')
                {    getdata();}
                else
                     $("#msg").html("Please enter Username & password");

            }
			 
        },{
            text: 'Reset',
            handler: function() {
                 $("#msg").html("");
                this.up('form').getForm().reset();
            }
        }]
    });

    //simple.render(document.body);
    simple.render(document.getElementById("showLoginfrm"));
});

    </script>
    <script src="jquery-latest.min.js" type="text/javascript"></script>
<script>
    $(document).ready(function(){
    //    $("#om").load("http://shubhalabha.in/community/wp-login.php");
    });
    function getdata()
    {
        $("#title_header_hd").html('<b><font color=#04408C>Login to Shubha Downloader </font><font color=green>Authenticating...</font></b>');
        var username=$("#user_login-inputEl").val();
        var password=$("#user_pass-inputEl").val();
        $.post("http://shubhalabha.in/community/wp-login.php",{log:username,pwd:password},function(data){
            $("#hidden").html(data);
            var err='om';
            err=$("#login_error").text();
            if(err.search('ERROR')>=0)
            { 
                $("#msg").html(err+' <a href=# onclick=lostpass()> Forgot Password?</a>');
            }
            else
            {
                $("#msg").html("You logged in. Transfer in Progress...");
                writelicence();
            }
            $("#title_header_hd").html('<b><font color=#04408C>Login to Shubha Downloader</font></b>');
        });
        
    }
    function lostpass()
    {
      var exec = require('child_process').exec,child;
                child = exec('start http://shubhalabha.in/community/wp-login.php?action=lostpassword',//child = exec('TASKKILL /F /IM nw.exe',
                function (error, stdout, stderr) {
                $("#msg").html("Please wait...While openining browser");
                if (error !== null) {
                $("#msg").html(error);
                   }
                });
    }

    function writelicence()
    {
        var fs =require('fs');
        var username=$("#user_login-inputEl").val();
        //var password=$("#user_pass-inputEl").val();
        fs.writeFile('licence.txt','Shubha Downloader licence :'+username+'\n Â©2013 Shbha Downloader.\nDeveloped by the XNet Inc.',function(err){
           if(err)console.log(err);
           else
           {console.log("ok");
           window.location.replace("index.html");}
        });
    }
    
</script>

  </head>
  <body >
     <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
          <tr height="33%">
            <td bgcolor="#DFF3FD">&nbsp;</td>
            <td bgcolor="#DFF3FD" align="center" valign="bottom">&nbsp;<img src="images/logo1.jpg" border="0" alt=""/></td>
            <td bgcolor="#DFF3FD">&nbsp;</td>
          </tr>
          <tr height="34%">
            <td width="33%" bgcolor="#DFF3FD">&nbsp;</td>
            <td width="34%" bgcolor="#DFF3FD" id="showLoginfrm">&nbsp;</td>
            <td width="33%" bgcolor="#DFF3FD">&nbsp;</td>
          </tr>
          <tr>
            <td bgcolor="#DFF3FD">&nbsp;</td>
            <td bgcolor="#DFF3FD">&nbsp;<div id="msg" style="color:#04408C;font-size: 11px"></div><div id="hidden" style="display: none"></div></td>
            <td bgcolor="#DFF3FD">&nbsp;</td>
          </tr>
          <tr height="33%">
            <td bgcolor="#DFF3FD">&nbsp;</td>
            <td bgcolor="#DFF3FD">&nbsp;</td>
            <td bgcolor="#DFF3FD">&nbsp;</td>
          </tr>
    </table>

  </body>
</html>
